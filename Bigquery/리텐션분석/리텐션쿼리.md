# 리텐션 쿼리

## N Day Retention
```
-- 절차
-- 1. base 만들기 (중복 제거 필요) with base as

-- 2. 유저 + 첫 접속일 테이블 만들기 first_data
 
-- 3. 유저 + 이벤트 발생 테이블 만들기 event_data

-- 4. 두 테이블 조인 (날짜간 차이 계산 컬럼 필요)  retain_base

-- 4-2. user_cnt컬럼 필요  user_counts = 이제부터 결과 테이블

-- 4-3. 비율 계산 2가지 방법
```
## Weekly Retention
```
N Day에서 event_date를 event_week으로 변경하면 됨

1. DATE_TRUNK(일자, 자를 기준)
    =  date_trunc(event_date,week(monday)) as event_week
2. WEEK
```